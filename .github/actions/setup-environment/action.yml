name: 'è®¾ç½®ç¯å¢ƒ'
description: 'åˆå§‹åŒ– Python ç¯å¢ƒå’Œä¾èµ–ï¼Œç”¨äºæ‰€æœ‰æ•°æ®å¤„ç†å·¥ä½œæµ'
author: 'SeerAPI'

inputs:
  python-version:
    description: 'Python ç‰ˆæœ¬'
    required: false
    default: '3.10'
  
  cache-key-suffix:
    description: 'ç¼“å­˜é”®åç¼€ï¼ˆç”¨äºåŒºåˆ†ä¸åŒçš„ç¼“å­˜ï¼‰'
    required: false
    default: ''
  
  install-dependencies:
    description: 'æ˜¯å¦å®‰è£…ä¾èµ–'
    required: false
    default: 'true'
  
  working-directory:
    description: 'å·¥ä½œç›®å½•ï¼ˆç”¨äºå®‰è£…ä¾èµ–ï¼‰'
    required: false
    default: '.'

outputs:
  python-version:
    description: 'å®‰è£…çš„ Python ç‰ˆæœ¬'
    value: ${{ steps.setup-python.outputs.python-version }}
  
  cache-hit:
    description: 'æ˜¯å¦å‘½ä¸­ç¼“å­˜'
    value: ${{ steps.setup-python.outputs.cache-hit }}

runs:
  using: 'composite'
  steps:
    - name: è®¾ç½® Python ${{ inputs.python-version }}
      id: setup-python
      uses: actions/setup-python@v5
      with:
        python-version: ${{ inputs.python-version }}
        cache: 'pip'
        cache-dependency-path: |
          **/pyproject.toml
          **/requirements.txt
          **/uv.lock
    
    - name: å®‰è£… uvï¼ˆå¿«é€ŸåŒ…ç®¡ç†å™¨ï¼‰
      if: inputs.install-dependencies == 'true'
      uses: astral-sh/setup-uv@v1
      with:
        uv-version: 'latest'
    
    - name: å®‰è£…ä¾èµ–
      if: inputs.install-dependencies == 'true'
      shell: bash
      working-directory: ${{ inputs.working-directory }}
      run: |
        echo "ğŸ“¥ å®‰è£…é¡¹ç›®ä¾èµ–..."
        uv sync

    - name: æ˜¾ç¤ºç¯å¢ƒä¿¡æ¯
      shell: bash
      run: |
        echo "=== Python ç¯å¢ƒä¿¡æ¯ ==="
        python --version
        echo ""
        echo "=== å·²å®‰è£…çš„åŒ… ==="
        uv pip list

